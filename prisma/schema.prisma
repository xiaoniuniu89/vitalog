generator client {
  provider = "prisma-client-js"
}

// datasource db {
//   provider = "postgresql"
//   url = "postgresql://u3qtrcn0u242f2:p17b2b59a5ab668bee96125f477529fb7a8945a9edf853d70fbef8999a8838ed5@c7u1tn6bvvsodf.cluster-czz5s0kz4scl.eu-west-1.rds.amazonaws.com:5432/d3m2ojf8ai0o94"
//   shadowDatabaseUrl = "postgresql://"
// }

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id           String           @id
  email        String           @unique
  first_name   String?
  last_name    String?
  entries      DiaryEntry[]
  weeklySummaries   WeeklySummary[]
  monthlySummaries  MonthlySummary[]
  yearlySummaries   YearlySummary[]
}

model DiaryEntry {
  id        String    @id @default(uuid())
  content   String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  user      User      @relation(fields: [userId], references: [id])
  userId    String
  analysis  String?
}

model WeeklySummary {
  id         String   @id @default(uuid())
  summary    String
  weekOfYear Int
  year       Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  user       User     @relation(fields: [userId], references: [id])
  userId     String

  @@unique([userId, weekOfYear, year])
}

model MonthlySummary {
  id        String   @id @default(uuid())
  summary   String
  month     Int
  year      Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id])
  userId    String

  @@unique([userId, month, year])
}

model YearlySummary {
  id        String   @id @default(uuid())
  summary   String
  year      Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id])
  userId    String

  @@unique([userId, year])
}